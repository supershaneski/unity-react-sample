{"ast":null,"code":"export default (function (containerElement) {\n  //console.log(containerElement.offsetWidth, containerElement.offsetHeight);\n  (function (window) {\n    'use strict';\n\n    function unityPlugin() {\n      var tdx = {};\n      var MAX_INDEX = 100000;\n      var retval = Array(MAX_INDEX + 1).fill();\n      var retindex = 0;\n\n      function getRetIndex() {\n        return retindex >= MAX_INDEX ? 0 : retindex++;\n      }\n\n      function getRetValue(index) {\n        var value = retval[index];\n        delete retval[index];\n        return value;\n      }\n\n      function sendMessage(func_name, param) {\n        if (typeof gameInstance === \"undefined\") {\n          //throw \"Calling:\" + func_name;\n          console.log(\"TDX : \" + func_name); //throw new Error(\"hey jude\");\n\n          return;\n        }\n\n        console.log(\"SEND MESSAGE : \" + func_name);\n        gameInstance.SendMessage(\"SceneManager\", func_name, param);\n        return true;\n      }\n\n      function makeParam() {\n        var param = {\n          index: arguments[0],\n          args: null\n        };\n\n        if (arguments.length > 1 && arguments[1] !== null) {\n          console.log(\"111\"); //param.args = JSON.stringify(Object.values(arguments[1]));\n\n          var _args = arguments[1]; //console.log(_args)\n\n          param.args = String(_args[0]);\n        }\n\n        console.log(\"222\", param);\n        return JSON.stringify(param);\n      } // Utility\n\n\n      tdx.SetRetValue = function (index, value) {\n        retval[index] = value;\n      }; // Events\n\n\n      tdx.OnLoad = function (callback) {\n        return callback;\n      };\n\n      tdx._OnLoad = function () {\n        this.OnLoad();\n      };\n\n      tdx.OnDeselect = function (callback) {\n        return callback;\n      };\n\n      tdx._OnDeselect = function () {\n        this.OnDeselect();\n      };\n\n      tdx.OnClick = function (callback) {\n        return callback;\n      };\n\n      tdx._OnClick = function (attr) {\n        this.OnClick(attr);\n      }; // Methods\n\n\n      tdx.GetTankProperty = function () {\n        var index = getRetIndex();\n        sendMessage(\"GetTankProperty\", makeParam(index, arguments));\n        return getRetValue(index);\n      };\n\n      tdx.GetTitle = function () {\n        var index = getRetIndex();\n        sendMessage(\"GetTitle\", makeParam(index));\n        return getRetValue(index);\n      };\n\n      tdx.SetTitle = function () {\n        sendMessage(\"SetTitle\", makeParam(-1, arguments));\n      };\n\n      tdx.SetPower = function () {\n        sendMessage(\"SetPower\", makeParam(-1, arguments));\n      };\n\n      tdx.Play = function () {\n        sendMessage(\"Play\", makeParam(-1, arguments));\n      };\n\n      tdx.Stop = function () {\n        sendMessage(\"Stop\", makeParam(-1, arguments));\n      };\n\n      Object.defineProperty(tdx.SetRetValue, \"name\", {\n        value: \"SetRetValue\"\n      });\n      return tdx;\n    }\n\n    if (typeof window.TdxPlayer === 'undefined') {\n      window.TdxPlayer = unityPlugin();\n    }\n\n    var gameInstance = UnityLoader.instantiate(\"unity-container\", \"/data/Build.json\");\n  })(window);\n\n  function foo() {\n    console.log(\"foo\");\n  }\n\n  function plugin() {\n    return window.TdxPlayer;\n  }\n\n  return {\n    foo: foo,\n    plugin: plugin\n  };\n});","map":{"version":3,"sources":["/Users/shane/Documents/projects/github/unity-react-sample/react-app/components/ShaneLoader.js"],"names":["containerElement","window","unityPlugin","tdx","MAX_INDEX","retval","Array","fill","retindex","getRetIndex","getRetValue","index","value","sendMessage","func_name","param","gameInstance","console","log","SendMessage","makeParam","arguments","args","length","_args","String","JSON","stringify","SetRetValue","OnLoad","callback","_OnLoad","OnDeselect","_OnDeselect","OnClick","_OnClick","attr","GetTankProperty","GetTitle","SetTitle","SetPower","Play","Stop","Object","defineProperty","TdxPlayer","UnityLoader","instantiate","foo","plugin"],"mappings":"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","sourcesContent":["export default containerElement => {\n    \n    //console.log(containerElement.offsetWidth, containerElement.offsetHeight);\n\n    (function(window){\n    \n        'use strict';\n\n        function unityPlugin() {\n            var tdx = {};\n            var MAX_INDEX = 100000;\n\t\t    var retval = Array(MAX_INDEX + 1).fill();\n            var retindex = 0;\n        \n            function getRetIndex()\n            {\n                return (retindex >= MAX_INDEX)?0:retindex++;\n            }\n            function getRetValue(index)\n            {\n                var value = retval[index];\n                delete retval[index];\n                return value;\n            }\n            function sendMessage(func_name, param)\n            {\n                if (typeof gameInstance === \"undefined\") {\n                    //throw \"Calling:\" + func_name;\n                    console.log(\"TDX : \" + func_name);\n                    //throw new Error(\"hey jude\");\n                    return;\n                }\n\n                console.log(\"SEND MESSAGE : \" + func_name);\n                gameInstance.SendMessage(\"SceneManager\", func_name, param);\n                return true;\n            }\n            function makeParam()\n            {\n                var param = {\n                    index: arguments[0],\n                    args: null\n                };\n\n                if (arguments.length > 1 && arguments[1] !== null)\n                {\n                    console.log(\"111\")\n                    //param.args = JSON.stringify(Object.values(arguments[1]));\n                    var _args = arguments[1];\n                    //console.log(_args)\n                    param.args = String(_args[0]);\n                }\n\n                console.log(\"222\", param)\n                \n                return JSON.stringify(param);\n            }\n\n            // Utility\n            tdx.SetRetValue = function(index, value)\n            {\n                retval[index] = value;\n            };\n\n            // Events\n            tdx.OnLoad = function(callback)\n            {\n                return callback;\n            };\n            tdx._OnLoad = function()\n            {\n                this.OnLoad();\n            };\n\n            tdx.OnDeselect = function(callback)\n            {\n                return callback;\n            };\n            tdx._OnDeselect = function()\n            {\n                this.OnDeselect();\n            };\n\n            tdx.OnClick = function(callback)\n            {\n                return callback;\n            };\n            tdx._OnClick = function(attr)\n            {\n                this.OnClick(attr);\n            };\n\n            // Methods\n            tdx.GetTankProperty = function()\n            {\n                var index = getRetIndex();\n                sendMessage(\"GetTankProperty\", makeParam(index, arguments));\n                return getRetValue(index);\n            };\n            \n            tdx.GetTitle = function()\n            {\n                var index = getRetIndex();\n                sendMessage(\"GetTitle\", makeParam(index));\n                return getRetValue(index);\n            };\n            tdx.SetTitle = function()\n            {\n                sendMessage(\"SetTitle\", makeParam(-1, arguments));\n            };\n\n            tdx.SetPower = function()\n            {\n                sendMessage(\"SetPower\", makeParam(-1, arguments));\n            };\n\n            tdx.Play = function()\n            {\n                sendMessage(\"Play\", makeParam(-1, arguments));\n            };\n\n            tdx.Stop = function()\n            {\n                sendMessage(\"Stop\", makeParam(-1, arguments));\n            };\n            \n            Object.defineProperty(tdx.SetRetValue, \"name\", { value: \"SetRetValue\" });\n\n            return tdx;\n            \n        }\n\n        if(typeof(window.TdxPlayer) === 'undefined'){\n            window.TdxPlayer = unityPlugin();\n        }\n\n        var gameInstance = UnityLoader.instantiate(\"unity-container\", \"/data/Build.json\");\n    \n    \n    })(window);\n\n    function foo() {\n        console.log(\"foo\");\n    }\n\n    function plugin() {\n        return window.TdxPlayer;\n    }\n\n    return {\n        foo,\n        plugin,\n    }\n}"]},"metadata":{},"sourceType":"module"}