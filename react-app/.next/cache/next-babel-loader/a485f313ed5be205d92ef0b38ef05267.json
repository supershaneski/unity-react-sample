{"ast":null,"code":"export default (function (containerElement) {\n  //console.log(containerElement.offsetWidth, containerElement.offsetHeight);\n  (function (window) {\n    'use strict';\n\n    function unityPlugin() {\n      var tdx = {};\n      var MAX_INDEX = 100000;\n      var retval = Array(MAX_INDEX + 1).fill();\n      var retindex = 0;\n\n      function getRetIndex() {\n        return retindex >= MAX_INDEX ? 0 : retindex++;\n      }\n\n      function getRetValue(index) {\n        var value = retval[index];\n        delete retval[index];\n        return value;\n      }\n\n      function sendMessage(func_name, param) {\n        if (typeof gameInstance === \"undefined\") {\n          //throw \"Calling:\" + func_name;\n          console.log(\"TDX : \" + func_name);\n          return;\n        }\n\n        console.log(\"SEND MESSAGE : \" + func_name);\n        gameInstance.SendMessage(\"SceneManager\", func_name, param);\n        return true;\n      }\n\n      function makeParam() {\n        var param = {\n          index: arguments[0],\n          args: null\n        };\n\n        if (arguments.length > 1 && arguments[1] !== null) {\n          //param.args = JSON.stringify(Object.values(arguments[1]));\n          param.args = arguments[1];\n        } //const sendData = JSON.stringify(param);\n        //console.log(sendData);\n        //return sendData;\n\n\n        return JSON.stringify(param);\n      } // Utility\n\n\n      tdx.SetRetValue = function (index, value) {\n        retval[index] = value;\n      }; // Events\n\n\n      tdx.OnLoad = function (callback) {\n        return callback;\n      };\n\n      tdx._OnLoad = function () {\n        this.OnLoad();\n      };\n\n      tdx.OnDeselect = function (callback) {\n        return callback;\n      };\n\n      tdx._OnDeselect = function () {\n        this.OnDeselect();\n      };\n\n      tdx.OnClick = function (callback) {\n        return callback;\n      };\n\n      tdx._OnClick = function (attr) {\n        this.OnClick(attr);\n      }; // Methods\n\n\n      tdx.GetTankProperty = function () {\n        var index = getRetIndex();\n        var propName = arguments[0];\n        sendMessage(\"GetTankProperty\", makeParam(index, propName));\n        return getRetValue(index);\n      };\n\n      tdx.SetTankColor = function () {\n        var index = getRetIndex();\n        sendMessage(\"SetTankColor\", makeParam(index));\n        return getRetValue(index);\n      };\n\n      tdx.SetTankColor = function () {\n        var color = arguments[0];\n        sendMessage(\"SetTankColor\", makeParam(-1, color));\n      };\n\n      tdx.GetTitle = function () {\n        var index = getRetIndex();\n        sendMessage(\"GetTitle\", makeParam(index));\n        return getRetValue(index);\n      };\n\n      tdx.SetTitle = function () {\n        var title = arguments[0];\n        sendMessage(\"SetTitle\", makeParam(-1, title));\n      };\n\n      tdx.GetRank = function () {\n        var index = getRetIndex();\n        sendMessage(\"GetRank\", makeParam(index));\n        return getRetValue(index);\n      };\n\n      tdx.SetRank = function () {\n        var rank = arguments[0];\n        sendMessage(\"SetRank\", makeParam(-1, rank));\n      };\n\n      tdx.GetPower = function () {\n        var index = getRetIndex();\n        sendMessage(\"GetPower\", makeParam(index));\n        return getRetValue(index);\n      };\n\n      tdx.SetPower = function () {\n        var power = arguments[0];\n        sendMessage(\"SetPower\", makeParam(-1, power));\n      };\n\n      tdx.GetArmor = function () {\n        var index = getRetIndex();\n        sendMessage(\"GetArmor\", makeParam(index));\n        return getRetValue(index);\n      };\n\n      tdx.SetArmor = function () {\n        var armor = arguments[0];\n        sendMessage(\"SetArmor\", makeParam(-1, armor));\n      };\n\n      tdx.GetSpeed = function () {\n        var index = getRetIndex();\n        sendMessage(\"GetSpeed\", makeParam(index));\n        return getRetValue(index);\n      };\n\n      tdx.SetSpeed = function () {\n        var speed = arguments[0];\n        sendMessage(\"SetSpeed\", makeParam(-1, speed));\n      };\n\n      tdx.Play = function () {\n        sendMessage(\"Play\", makeParam(-1, arguments));\n      };\n\n      tdx.Stop = function () {\n        sendMessage(\"Stop\", makeParam(-1, arguments));\n      };\n\n      Object.defineProperty(tdx.SetRetValue, \"name\", {\n        value: \"SetRetValue\"\n      });\n      return tdx;\n    }\n\n    if (typeof window.TdxPlayer === 'undefined') {\n      window.TdxPlayer = unityPlugin();\n    }\n\n    var gameInstance = UnityLoader.instantiate(\"unity-container\", \"/data/Build.json\");\n  })(window);\n\n  function foo() {\n    console.log(\"foo\");\n  }\n\n  function plugin() {\n    return window.TdxPlayer;\n  }\n\n  return {\n    foo: foo,\n    plugin: plugin\n  };\n});","map":{"version":3,"sources":["/Users/shane/Documents/projects/github/unity-react-sample/react-app/components/ShaneLoader.js"],"names":["containerElement","window","unityPlugin","tdx","MAX_INDEX","retval","Array","fill","retindex","getRetIndex","getRetValue","index","value","sendMessage","func_name","param","gameInstance","console","log","SendMessage","makeParam","arguments","args","length","JSON","stringify","SetRetValue","OnLoad","callback","_OnLoad","OnDeselect","_OnDeselect","OnClick","_OnClick","attr","GetTankProperty","propName","SetTankColor","color","GetTitle","SetTitle","title","GetRank","SetRank","rank","GetPower","SetPower","power","GetArmor","SetArmor","armor","GetSpeed","SetSpeed","speed","Play","Stop","Object","defineProperty","TdxPlayer","UnityLoader","instantiate","foo","plugin"],"mappings":"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","sourcesContent":["export default containerElement => {\n    \n    //console.log(containerElement.offsetWidth, containerElement.offsetHeight);\n\n    (function(window){\n    \n        'use strict';\n\n        function unityPlugin() {\n\n            var tdx = {};\n\n            var MAX_INDEX = 100000;\n\t\t    var retval = Array(MAX_INDEX + 1).fill();\n            var retindex = 0;\n        \n            function getRetIndex()\n            {\n                return (retindex >= MAX_INDEX)?0:retindex++;\n            }\n            function getRetValue(index)\n            {\n                var value = retval[index];\n                delete retval[index];\n                return value;\n            }\n            function sendMessage(func_name, param)\n            {\n                if (typeof gameInstance === \"undefined\") {\n                    //throw \"Calling:\" + func_name;\n                    console.log(\"TDX : \" + func_name);\n                    return;\n                }\n\n                console.log(\"SEND MESSAGE : \" + func_name);\n                gameInstance.SendMessage(\"SceneManager\", func_name, param);\n                return true;\n            }\n            \n            function makeParam()\n            {\n                var param = {\n                    index: arguments[0],\n                    args: null\n                };\n\n                if (arguments.length > 1 && arguments[1] !== null)\n                {\n                    //param.args = JSON.stringify(Object.values(arguments[1]));\n                    param.args = arguments[1];\n                }\n                \n                //const sendData = JSON.stringify(param);\n                //console.log(sendData);\n                //return sendData;\n                \n                return JSON.stringify(param);\n            }\n\n            // Utility\n            tdx.SetRetValue = function(index, value)\n            {\n                retval[index] = value;\n            };\n\n            // Events\n            tdx.OnLoad = function(callback)\n            {\n                return callback;\n            };\n            tdx._OnLoad = function()\n            {\n                this.OnLoad();\n            };\n\n            tdx.OnDeselect = function(callback)\n            {\n                return callback;\n            };\n            tdx._OnDeselect = function()\n            {\n                this.OnDeselect();\n            };\n\n            tdx.OnClick = function(callback)\n            {\n                return callback;\n            };\n            tdx._OnClick = function(attr)\n            {\n                this.OnClick(attr);\n            };\n\n            // Methods\n            tdx.GetTankProperty = function()\n            {\n                var index = getRetIndex();\n                var propName = arguments[0];\n                sendMessage(\"GetTankProperty\", makeParam(index, propName));\n                return getRetValue(index);\n            };\n\n            tdx.SetTankColor = function()\n            {\n                var index = getRetIndex();\n                sendMessage(\"SetTankColor\", makeParam(index));\n                return getRetValue(index);\n            };\n            tdx.SetTankColor = function()\n            {\n                var color = arguments[0];\n                sendMessage(\"SetTankColor\", makeParam(-1, color));\n            };\n            \n            tdx.GetTitle = function()\n            {\n                var index = getRetIndex();\n                sendMessage(\"GetTitle\", makeParam(index));\n                return getRetValue(index);\n            };\n            tdx.SetTitle = function()\n            {\n                const title = arguments[0];\n                sendMessage(\"SetTitle\", makeParam(-1, title));\n                \n            };\n\n            tdx.GetRank = function()\n            {\n                var index = getRetIndex();\n                sendMessage(\"GetRank\", makeParam(index));\n                return getRetValue(index);\n            };\n            tdx.SetRank = function()\n            {\n                const rank = arguments[0];\n                sendMessage(\"SetRank\", makeParam(-1, rank));\n            };\n\n            tdx.GetPower = function()\n            {\n                var index = getRetIndex();\n                sendMessage(\"GetPower\", makeParam(index));\n                return getRetValue(index);\n            };\n            tdx.SetPower = function()\n            {\n                var power = arguments[0];\n                sendMessage(\"SetPower\", makeParam(-1, power));\n            };\n\n            tdx.GetArmor = function()\n            {\n                var index = getRetIndex();\n                sendMessage(\"GetArmor\", makeParam(index));\n                return getRetValue(index);\n            };\n            tdx.SetArmor = function()\n            {\n                var armor = arguments[0];\n                sendMessage(\"SetArmor\", makeParam(-1, armor));\n            };\n\n            tdx.GetSpeed = function()\n            {\n                var index = getRetIndex();\n                sendMessage(\"GetSpeed\", makeParam(index));\n                return getRetValue(index);\n            };\n            tdx.SetSpeed = function()\n            {\n                var speed = arguments[0];\n                sendMessage(\"SetSpeed\", makeParam(-1, speed));\n            };\n\n            tdx.Play = function()\n            {\n                sendMessage(\"Play\", makeParam(-1, arguments));\n            };\n\n            tdx.Stop = function()\n            {\n                sendMessage(\"Stop\", makeParam(-1, arguments));\n            };\n            \n            Object.defineProperty(tdx.SetRetValue, \"name\", { value: \"SetRetValue\" });\n\n            return tdx;\n            \n        }\n\n        if(typeof(window.TdxPlayer) === 'undefined'){\n            window.TdxPlayer = unityPlugin();\n        }\n\n        var gameInstance = UnityLoader.instantiate(\"unity-container\", \"/data/Build.json\");\n    \n    \n    })(window);\n\n    function foo() {\n        console.log(\"foo\");\n    }\n\n    function plugin() {\n        return window.TdxPlayer;\n    }\n\n    return {\n        foo,\n        plugin,\n    }\n}"]},"metadata":{},"sourceType":"module"}